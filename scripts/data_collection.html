<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Collecte et extractions des données – Mandat analyse de données de ventes Dunin</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../scripts/data_cleaning.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1413945d4a89061271b08486dee2c8de.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../scripts/data_collection.html">Phase 1 : collecte de données</a></li><li class="breadcrumb-item"><a href="../scripts/data_collection.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecte et extractions des données</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mandat analyse de données de ventes Dunin</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/datchaa/dunin_etl" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Acceuil</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 1 : collecte de données</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../scripts/data_collection.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecte et extractions des données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../scripts/data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Néttoyage et transformations des données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../scripts/data_loading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chargement des données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../scripts/data_exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analyse exploratoire de données</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Phase 2 : Implémentation de l'architecture ETL (Microsoft SSIS)</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#identification-et-collecte-des-sources-de-données" id="toc-identification-et-collecte-des-sources-de-données" class="nav-link active" data-scroll-target="#identification-et-collecte-des-sources-de-données"><span class="header-section-number">3</span> Identification et collecte des sources de données</a></li>
  <li><a href="#connection-à-la-base-données" id="toc-connection-à-la-base-données" class="nav-link" data-scroll-target="#connection-à-la-base-données"><span class="header-section-number">4</span> connection à la base données</a></li>
  <li><a href="#critiques-des-données" id="toc-critiques-des-données" class="nav-link" data-scroll-target="#critiques-des-données"><span class="header-section-number">5</span> critiques des données</a></li>
  <li><a href="#selection-des-données" id="toc-selection-des-données" class="nav-link" data-scroll-target="#selection-des-données"><span class="header-section-number">6</span> selection des données</a></li>
  <li><a href="#collecte-des-fichiers-xmls" id="toc-collecte-des-fichiers-xmls" class="nav-link" data-scroll-target="#collecte-des-fichiers-xmls"><span class="header-section-number">7</span> Collecte des fichiers xmls</a>
  <ul class="collapse">
  <li><a href="#chargement-des-fichiers-xmls" id="toc-chargement-des-fichiers-xmls" class="nav-link" data-scroll-target="#chargement-des-fichiers-xmls"><span class="header-section-number">7.1</span> chargement des fichiers xmls</a></li>
  <li><a href="#méthodologie-dextraction" id="toc-méthodologie-dextraction" class="nav-link" data-scroll-target="#méthodologie-dextraction"><span class="header-section-number">7.2</span> Méthodologie d’extraction</a></li>
  <li><a href="#processus-dextraction-par-type" id="toc-processus-dextraction-par-type" class="nav-link" data-scroll-target="#processus-dextraction-par-type"><span class="header-section-number">7.3</span> Processus d’extraction par type</a></li>
  </ul></li>
  <li><a href="#données-extraites" id="toc-données-extraites" class="nav-link" data-scroll-target="#données-extraites"><span class="header-section-number">8</span> Données extraites</a>
  <ul class="collapse">
  <li><a href="#commandes" id="toc-commandes" class="nav-link" data-scroll-target="#commandes"><span class="header-section-number">8.1</span> Commandes</a></li>
  <li><a href="#contrats" id="toc-contrats" class="nav-link" data-scroll-target="#contrats"><span class="header-section-number">8.2</span> Contrats</a></li>
  <li><a href="#projets" id="toc-projets" class="nav-link" data-scroll-target="#projets"><span class="header-section-number">8.3</span> Projets</a></li>
  </ul></li>
  <li><a href="#modèle-de-données-résultant" id="toc-modèle-de-données-résultant" class="nav-link" data-scroll-target="#modèle-de-données-résultant"><span class="header-section-number">9</span> Modèle de données résultant</a>
  <ul class="collapse">
  <li><a href="#tables-principales" id="toc-tables-principales" class="nav-link" data-scroll-target="#tables-principales"><span class="header-section-number">9.1</span> Tables principales</a></li>
  <li><a href="#modèle-relationnelle-des-données-extraites" id="toc-modèle-relationnelle-des-données-extraites" class="nav-link" data-scroll-target="#modèle-relationnelle-des-données-extraites"><span class="header-section-number">9.2</span> Modèle relationnelle des données extraites</a></li>
  </ul></li>
  <li><a href="#dictionnaire-de-données-sélectionnées" id="toc-dictionnaire-de-données-sélectionnées" class="nav-link" data-scroll-target="#dictionnaire-de-données-sélectionnées"><span class="header-section-number">10</span> Dictionnaire de données sélectionnées</a>
  <ul class="collapse">
  <li><a href="#table-commandes" id="toc-table-commandes" class="nav-link" data-scroll-target="#table-commandes"><span class="header-section-number">10.1</span> table commandes</a></li>
  <li><a href="#table-contrats" id="toc-table-contrats" class="nav-link" data-scroll-target="#table-contrats"><span class="header-section-number">10.2</span> table contrats</a></li>
  <li><a href="#table-projets" id="toc-table-projets" class="nav-link" data-scroll-target="#table-projets"><span class="header-section-number">10.3</span> table projets</a></li>
  <li><a href="#table-kits-kit-kitmur-kitplafond." id="toc-table-kits-kit-kitmur-kitplafond." class="nav-link" data-scroll-target="#table-kits-kit-kitmur-kitplafond."><span class="header-section-number">10.4</span> table kits { kit , kitMur , KitPlafond,….}</a></li>
  <li><a href="#table-etapes" id="toc-table-etapes" class="nav-link" data-scroll-target="#table-etapes"><span class="header-section-number">10.5</span> table etapes</a></li>
  <li><a href="#tables-addresses" id="toc-tables-addresses" class="nav-link" data-scroll-target="#tables-addresses"><span class="header-section-number">10.6</span> tables addresses</a></li>
  <li><a href="#lumière" id="toc-lumière" class="nav-link" data-scroll-target="#lumière"><span class="header-section-number">10.7</span> lumière</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">11</span> conclusion</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/datchaa/dunin_etl/blob/main/scripts/data_collection.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../scripts/data_collection.html">Phase 1 : collecte de données</a></li><li class="breadcrumb-item"><a href="../scripts/data_collection.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecte et extractions des données</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecte et extractions des données</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="identification-et-collecte-des-sources-de-données" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Identification et collecte des sources de données</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>Type</th>
<th>méthode de collection</th>
<th>description</th>
<th>fréquence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>avivia</td>
<td>Base de données SQL (OLTP)</td>
<td>semi- automatisé via Eve</td>
<td>Base de donnée transactionnel des activités de ventes</td>
<td>Temps réel</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="connection-à-la-base-données" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> connection à la base données</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"C:/Users/18195/Documents/dunin/utils/extract/sql_server.R"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">get_sqlServerCon_by_server_auth</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">server_name =</span> <span class="fu">Sys.getenv</span>(<span class="st">'Avivia_HOST_SERVER'</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">db_name =</span> <span class="fu">Sys.getenv</span>(<span class="st">'Avivia_DB_NAME'</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">user_name =</span> <span class="fu">Sys.getenv</span>(<span class="st">'Avivia_DB_USER'</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">passwrd =</span> <span class="fu">Sys.getenv</span>(<span class="st">'Avivia_DB_PWD'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"C:/Users/18195/Documents/dunin/utils/extract/standard.R"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>con <span class="sc">|&gt;</span> <span class="fu">show_tables</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CommEW"          "CommEWArch"      "CommHistoEW"     "CommLogEW"      
 [5] "ComposRepriseEW" "ContratEW"       "ContratHistoEW"  "ContratLogEW"   
 [9] "DeductionEW"     "eCommerceEW"     "EventEW"         "exportProjet"   
[13] "ProjetEW"        "ProjetLogEW"     "SequenceEW"      "SessionEW"      
[17] "SessionExtEW"    "Sessions"        "sysdiagrams"     "UsagerEW"       
[21] "UsagerInfoEW"    "UsagerLogEW"     "UsagerParamRole"</code></pre>
</div>
</div>
</section>
<section id="critiques-des-données" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> critiques des données</h1>
</section>
<section id="selection-des-données" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> selection des données</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>commandes <span class="ot">&lt;-</span> <span class="fu">get_table_in_lazy_method</span>(con,<span class="st">"CommEW"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>contrats <span class="ot">&lt;-</span> <span class="fu">get_table_in_lazy_method</span>(con,<span class="st">"ContratEW"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>projets <span class="ot">&lt;-</span> <span class="fu">get_table_in_lazy_method</span>(con,<span class="st">"ProjetEW"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>commandes <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: ??
Columns: 37
Database: Microsoft SQL Server 12.00.0601[accesAviviaData@server-sql-dunin-eve/AviviaEve_Copy]
$ Code                &lt;chr&gt; "C-000089", "C-000093", "C-000115", "C-000119", "C…
$ Projet              &lt;chr&gt; "P-000175", "P-000181", "P-000219", "P-000223", "P…
$ Archive             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ Abandon             &lt;int&gt; 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0,…
$ Emplacement         &lt;chr&gt; "Manufacturier", "Manufacturier", "Client", "Clien…
$ Statut              &lt;chr&gt; "Installation", "Installation", "Installation", "I…
$ Createur            &lt;chr&gt; "dunintech", "glebel", "clientweb", "clientweb", "…
$ Editeur             &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", ""…
$ DocumXML            &lt;chr&gt; "&lt;xmlDunin version='1.00'&gt;&lt;obj clas='Comm'&gt;&lt;prop n…
$ EveXML              &lt;chr&gt; "&lt;xmlDunin version='1.00'&gt;&lt;obj clas='Ingenierie'&gt;&lt;…
$ ERPXML              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ FlagERP             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ DocumRef            &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", ""…
$ Avis                &lt;int&gt; 0, 0, 1, 1, 1, 0, NA, 0, 1, 1, 1, NA, 0, 0, 1, 0, …
$ RequisMatXML        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ EstimeNestingXML    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ RequisNestingXML    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ CtrlNesting         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ FicCNCSauve         &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ EtapeTransfertERP   &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ Proprietaire        &lt;chr&gt; "dunintech", "glebel", "clientweb", "clientweb", "…
$ BomXML              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ DateCreation        &lt;dttm&gt; 2023-08-30 14:48:34, 2023-08-31 13:11:14, 2023-09…
$ LienERP             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ EtiquettesHTML      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ AdresseCourrielComm &lt;chr&gt; "{\"infos\":[{\"etape\":\"Saisie\",\"email_From\":…
$ TypeProcess         &lt;chr&gt; "interne", "interne", "externe", "externe", "exter…
$ bomJSON             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export1             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export2             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export3             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export4             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export5             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ refExterne          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ timeStamp           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ ref1                &lt;chr&gt; "", "", "", "", "", "", "", "cuisine 2", "", "test…
$ ref2                &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", ""…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>contrats <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: ??
Columns: 38
Database: Microsoft SQL Server 12.00.0601[accesAviviaData@server-sql-dunin-eve/AviviaEve_Copy]
$ Code                &lt;chr&gt; "P-001666-S1", "P-001471-S8", "P-000907-S1", "P-00…
$ Projet              &lt;chr&gt; "P-001666", "P-001471", "P-000907", "P-001681", "P…
$ Archive             &lt;int&gt; 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0,…
$ Abandon             &lt;int&gt; 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,…
$ Emplacement         &lt;chr&gt; "Manufacturier", "Manufacturier", "Manufacturier",…
$ Statut              &lt;chr&gt; "Saisie", "Saisie", "Saisie", "Saisie", "Saisie", …
$ Createur            &lt;chr&gt; "alaplante", "abreault", "abreault", "rbouchard@av…
$ Editeur             &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", ""…
$ DocumXML            &lt;chr&gt; "&lt;xmlDunin version='1.00'&gt;&lt;obj clas='Contrat'&gt;&lt;pro…
$ EveXML              &lt;chr&gt; "&lt;xmlDunin version='1.00'&gt;&lt;obj clas='Ingenierie'&gt;&lt;…
$ ERPXML              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ DocumRef            &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", ""…
$ DernierJourValide   &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Avis                &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ RequisMatXML        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ EstimeNestingXML    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ RequisNestingXML    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ CtrlNesting         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ FicCNCSauve         &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ EtapeTransfertERP   &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ Proprietaire        &lt;chr&gt; "alaplante", "abreault", "abreault", "rbouchard@av…
$ BomXML              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ DateCreation        &lt;dttm&gt; 2025-01-09 21:23:06, 2025-01-13 15:13:06, 2025-02…
$ LienERP             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ EtiquettesHTML      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ FlagERP             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ AdresseCourrielComm &lt;chr&gt; "{\"infos\":[{\"etape\":\"Saisie\",\"email_From\":…
$ TypeProcess         &lt;chr&gt; "interne", "interne", "interne", "interne", "inter…
$ bomJSON             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export1             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export2             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export3             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export4             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ export5             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ refExterne          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ timeStamp           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ ref1                &lt;chr&gt; "Cuisine V1", "Plan cuisine (version 2)", "Cuisine…
$ ref2                &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", ""…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>projets <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: ??
Columns: 7
Database: Microsoft SQL Server 12.00.0601[accesAviviaData@server-sql-dunin-eve/AviviaEve_Copy]
$ Code         &lt;chr&gt; "P-000001", "P-000002", "P-000004", "P-000006", "P-000011…
$ Client       &lt;chr&gt; "Avivia", "", "", "", "", "Avivia", "", "CRobitaille", "A…
$ Createur     &lt;chr&gt; "1", "1", "glebel", "glebel", "glebel", "1", "glebel", "c…
$ ProjetXML    &lt;chr&gt; "&lt;xmlDunin version='1.00'&gt;&lt;obj clas='Projet'&gt;&lt;prop nom='$…
$ Archive      &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ DateCreation &lt;dttm&gt; 2022-07-21 12:33:39, 2022-10-12 18:18:16, 2022-10-12 20:…
$ Libre        &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Après une analyse des champs des différentes tables, nous avons choisi de nous concentrer sur ceux contenant des fichiers XML notemment : <strong><em><code>DocumXML</code></em>, <em><code>EveXML</code></em></strong> et <em><code>ProjetXML</code></em> . Ces derniers non seulement synthétisent les informations de chaque table, mais renferment également davantage de données pertinentes et intéressantes.</p>
</div>
</div>
</section>
<section id="collecte-des-fichiers-xmls" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Collecte des fichiers xmls</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>projets_xmls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">projetXMLS =</span> projets <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(ProjetXML),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ids =</span>  projets <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(Code)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(projets_xmls,<span class="at">file =</span><span class="st">"data/raw/xml/projets_xmls.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>commandes_xmls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">DocumXMLS =</span> commandes<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(DocumXML),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">EveXMLS   =</span> commandes<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(EveXML),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ids  =</span> commandes<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(Code)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(commandes_xmls,<span class="at">file =</span><span class="st">"data/raw/xml/commandes_xmls.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>contrats_xmls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">DocumXMLS =</span> contrats<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(DocumXML),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">EveXMLS   =</span> contrats<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(EveXML),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ids  =</span> contrats<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(Code) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(contrats_xmls,<span class="at">file =</span><span class="st">"data/raw/xml/contrats_xmls.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>s.</p>
<section id="chargement-des-fichiers-xmls" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="chargement-des-fichiers-xmls"><span class="header-section-number">7.1</span> chargement des fichiers xmls</h2>
<p>Le système traite trois types de documents XML :</p>
<p>Projets : Informations sur les projets clients et leurs caractéristiques Commandes : Données commerciales et d’ingenierie des commandes (DocumXML et EveXML) Contrats : Informations contractuelles et d’ingenierie (DocumXML et EveXML)</p>
<p>Chaque type de document contient des structures hiérarchiques avec des objets (<obj>) et des propriétés (<prop>) qu’il faut normaliser en tables plates.</prop></obj></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"C:/Users/18195/Documents/dunin/utils/extract/xml.R"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/18195/Documents/dunin/data/raw/xml/commandes_xmls.RData"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/18195/Documents/dunin/data/raw/xml/contrats_xmls.RData"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/18195/Documents/dunin/data/raw/xml/projets_xmls.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="méthodologie-dextraction" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="méthodologie-dextraction"><span class="header-section-number">7.2</span> Méthodologie d’extraction</h2>
<p>Fonctions principales développées</p>
<p><strong><em>convert_xml_file_To_Tibble()</em></strong></p>
<p>Cette fonction constitue le cœur du processus d’extraction :</p>
<ul>
<li><p>Objectif : Convertir un document XML en liste de tables classées par type d’objet</p></li>
<li><p>Mécanisme : Parcours récursif des nœuds <obj> pour extraire les propriétés de type <prop></prop></obj></p></li>
<li><p>Filtrage : Possibilité de sélectionner des classes spécifiques via le paramètre select_clas Validation : Vérification de cohérence entre noms de propriétés et valeurs</p></li>
</ul>
<p><strong><em>convert_Xmlfiles_Data_from_tableToTbls()</em></strong></p>
<p>Fonction d’agrégation permettant de :</p>
<p>Traiter une liste complète de fichiers XML Ajouter des identifiants parents pour maintenir la traçabilité Fusionner les tables par classe d’objet Garantir l’intégrité référentielle entre fichiers</p>
</section>
<section id="processus-dextraction-par-type" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="processus-dextraction-par-type"><span class="header-section-number">7.3</span> Processus d’extraction par type</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)      <span class="co"># Pour lire et manipuler des fichiers XML</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)     <span class="co"># Pour manipuler les tableaux de données (tibbles)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)     <span class="co"># Pour les fonctions de programmation fonctionnelle (map, walk, etc.)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)   <span class="co"># Pour manipuler les chaînes de caractères</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)    <span class="co"># Pour créer des objets tibbles (données tabulaires modernes)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction : convert_xml_file_To_Tibble</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Objectif : Convertir un document XML en une liste de tables (tibbles) classées par type d'objet</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>convert_xml_file_To_Tibble <span class="ot">&lt;-</span> <span class="cf">function</span>(doc, <span class="at">select_clas =</span> <span class="cn">NULL</span>) {</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Étape 1 : Vérification et conversion de l'objet XML ---</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(doc, <span class="st">"xml_document"</span>)) {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      doc <span class="ot">&lt;-</span> <span class="fu">as_xml_document</span>(doc)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"L'entrée a été convertie en un objet xml_document </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    root <span class="ot">&lt;-</span> <span class="fu">xml_root</span>(doc)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(root)) {</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">"Le document XML est vide"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>())</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Étape 2 : Préparer le filtre de sélection ---</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    select_pattern <span class="ot">&lt;-</span> <span class="fu">as.character</span>(select_clas <span class="sc">%||%</span> <span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    has_selection <span class="ot">&lt;-</span> <span class="fu">length</span>(select_pattern) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Étape 3 : Initialiser le conteneur de résultats ---</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    tables <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Étape 4 : Fonction récursive de parcours des noeuds &lt;obj&gt; ---</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    parse_obj <span class="ot">&lt;-</span> <span class="cf">function</span>(node) {</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tryCatch</span>({</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        clas <span class="ot">&lt;-</span> <span class="fu">xml_attr</span>(node, <span class="st">"clas"</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">is.na</span>(clas) <span class="sc">||</span> <span class="fu">is.null</span>(clas)) <span class="fu">return</span>()</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Si sélection active, ignorer les noeuds non correspondants</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (has_selection) {</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>          keep <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(clas, <span class="fu">regex</span>(select_pattern, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span>keep) <span class="fu">return</span>()</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extraire les propriétés de type &lt;prop&gt; sans sous-éléments</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>        props <span class="ot">&lt;-</span> <span class="fu">xml_find_all</span>(node, <span class="st">"./prop[not(*) and not(.//obj)]"</span>)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(props) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>()</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>        texts <span class="ot">&lt;-</span> <span class="fu">xml_text</span>(props) <span class="sc">%&gt;%</span> <span class="fu">trimws</span>()</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>        names <span class="ot">&lt;-</span> <span class="fu">xml_attr</span>(props, <span class="st">"nom"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">$"</span>)</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Vérification cohérence nom/valeur</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(texts) <span class="sc">!=</span> <span class="fu">length</span>(names)) {</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>          <span class="fu">warning</span>(<span class="fu">sprintf</span>(<span class="st">"Incohérence dans %s : %d valeurs / %d noms"</span>,</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>                          clas, <span class="fu">length</span>(texts), <span class="fu">length</span>(names)))</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>()</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Création d'une ligne de données nommée</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>        row <span class="ot">&lt;-</span> <span class="fu">set_names</span>(texts, names)</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ajout de la ligne à la bonne table</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">is.null</span>(tables[[clas]])) tables[[clas]] <span class="ot">&lt;&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>        tables[[clas]] <span class="ot">&lt;&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>(tables[[clas]], <span class="fu">as_tibble_row</span>(row)),</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(<span class="fu">sprintf</span>(<span class="st">"bind_rows échoue pour %s : %s"</span>, clas, e<span class="sc">$</span>message))</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>            tables[[clas]]</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Parcours récursif des objets enfants</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>        children <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">xml_find_all</span>(node, <span class="st">"./prop//obj"</span>),</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">xml_find_all</span>(node, <span class="st">"./prop//entr/obj"</span>))</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>        <span class="fu">walk</span>(children, parse_obj)</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="fu">sprintf</span>(<span class="st">"Erreur lors du traitement du nœud : %s"</span>, e<span class="sc">$</span>message))</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Étape 5 : Démarrer l'extraction à partir des objets &lt;obj&gt; ---</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>    objs <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">xml_find_all</span>(root, <span class="st">".//obj"</span>),</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>                     <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">xml_nodeset</span>())</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(objs)) <span class="fu">walk</span>(objs, parse_obj)</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Étape 6 : Nettoyer les noms de colonnes (supprimer les caractères non alphanumériques) ---</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>    tables <span class="ot">&lt;-</span> <span class="fu">map</span>(tables, <span class="sc">~</span> <span class="fu">tryCatch</span>(</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename_with</span>(., <span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>)),</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e) .</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Conversion terminée</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tables)</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">"Erreur globale :"</span>, e<span class="sc">$</span>message)</span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>())</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction : convert_Xmlfiles_Data_ToTbl</span></span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Objectif : Convertir une liste de fichiers XML en une liste de tables unifiées (fusionnées par classe)</span></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>convert_Xmlfiles_Data_from_tableToTbls <span class="ot">&lt;-</span> <span class="cf">function</span>(files, <span class="at">select_clas =</span> <span class="cn">NULL</span>, <span class="at">parentName =</span> <span class="cn">NULL</span>, <span class="at">parentIDS =</span> <span class="cn">NULL</span>) {</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vérifier que parentName et parentIDS sont fournis ensemble</span></span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(parentName) <span class="sc">||</span> <span class="fu">is.null</span>(parentIDS)) {</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"parentName et parentIDS doivent être fournis ensemble ou non fournis du tout"</span>)</span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vérifier que files et parentIDS ont la même longueur si parentIDS est fourni</span></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(parentIDS) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(files) <span class="sc">!=</span> <span class="fu">length</span>(parentIDS)) {</span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"La longueur de 'files' doit être égale à celle de 'parentIDS'"</span>)</span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Appliquer la conversion à chaque fichier avec son ID parent associé</span></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(files), <span class="cf">function</span>(i) {</span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a>    tbls <span class="ot">&lt;-</span> <span class="fu">convert_xml_file_To_Tibble</span>(files[[i]], select_clas)</span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajouter la colonne parent si parentName et parentIDS sont fournis</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(parentName) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(parentIDS)) {</span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>      tbls <span class="ot">&lt;-</span> <span class="fu">lapply</span>(tbls, <span class="cf">function</span>(tbl) {</span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">is.data.frame</span>(tbl) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>          tbl[[parentName]] <span class="ot">&lt;-</span> parentIDS[[i]]</span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>          tbl</span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>          tbl</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>    tbls</span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fusionner les tables par nom de classe (clé de liste)</span></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a>  tbls <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(data[[<span class="dv">1</span>]]), <span class="cf">function</span>(tblName) {</span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(data, tblName)</span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tbls) <span class="ot">&lt;-</span> <span class="fu">names</span>(data[[<span class="dv">1</span>]])</span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tbls)</span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>projets_xmls_extracted_tables <span class="ot">&lt;-</span> <span class="fu">convert_Xmlfiles_Data_from_tableToTbls</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">files =</span> projets_xmls<span class="sc">$</span>projetXMLS,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parentName =</span> <span class="st">"projet_id"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">parentIDS =</span> projets_xmls<span class="sc">$</span>Ids</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(projets_xmls_extracted_tables,<span class="at">file=</span><span class="st">"data/extracted/projets_xmls_extracted_tables.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>commandes_xmls_extracted_tables <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>commandes_xmls_extracted_tables<span class="sc">$</span>DocumXML<span class="ot">&lt;-</span><span class="fu">convert_Xmlfiles_Data_from_tableToTbls</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> <span class="at">files =</span> commandes_xmls<span class="sc">$</span>DocumXMLS,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a> <span class="at">parentName =</span> <span class="st">"commande_id"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a> <span class="at">parentIDS =</span> commandes_xmls<span class="sc">$</span>Ids</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>commandes_xmls_extracted_tables<span class="sc">$</span>EveXML<span class="ot">&lt;-</span><span class="fu">convert_Xmlfiles_Data_from_tableToTbls</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a> <span class="at">files =</span> commandes_xmls<span class="sc">$</span>EveXMLS,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a> <span class="at">select_clas =</span> <span class="st">'kit'</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a> <span class="at">parentName =</span> <span class="st">"commande_id"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a> <span class="at">parentIDS =</span> commandes_xmls<span class="sc">$</span>Ids</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(commandes_xmls_extracted_tables,<span class="at">file=</span><span class="st">"data/extracted/commandes_xmls_extracted_tables.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>contrats_xmls_extracted_tables <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>contrats_xmls_extracted_tables<span class="sc">$</span>DocumXML<span class="ot">&lt;-</span><span class="fu">convert_Xmlfiles_Data_from_tableToTbls</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a> <span class="at">files =</span> contrats_xmls<span class="sc">$</span>DocumXMLS,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a> <span class="at">parentName =</span> <span class="st">"contrat_id"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a> <span class="at">parentIDS =</span> contrats_xmls<span class="sc">$</span>Ids</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>contrats_xmls_extracted_tables<span class="sc">$</span>EveXML<span class="ot">&lt;-</span><span class="fu">convert_Xmlfiles_Data_from_tableToTbls</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a> <span class="at">files =</span> contrats_xmls<span class="sc">$</span>EveXMLS,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a> <span class="at">parentName =</span> <span class="st">"contrat_id"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a> <span class="at">select_clas =</span> <span class="st">'kit'</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a> <span class="at">parentIDS =</span> contrats_xmls<span class="sc">$</span>Ids</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(contrats_xmls_extracted_tables,<span class="at">file=</span><span class="st">"data/extracted/contrats_xmls_extracted_tables.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="données-extraites" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Données extraites</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/18195/Documents/dunin/data/extracted/commandes_xmls_extracted_tables.RData"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/18195/Documents/dunin/data/extracted/contrats_xmls_extracted_tables.RData"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/18195/Documents/dunin/data/extracted/projets_xmls_extracted_tables.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="commandes" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="commandes"><span class="header-section-number">8.1</span> Commandes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>commandes_xmls_extracted_tables<span class="sc">$</span>DocumXML <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Comm
# A tibble: 714 × 173
   aNote   documSource estCQ   estCQSup estImport estReprise dateAcompte1Emis
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;           
 1 "false" "false"     "false" "false"  "false"   "false"    2023/08/30      
 2 ""      ""          ""      ""       ""        ""         &lt;NA&gt;            
 3 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
 4 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
 5 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
 6 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
 7 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
 8 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
 9 "false" "false"     "false" "false"  "false"   "false"    &lt;NA&gt;            
10 "false" "false"     "false" "false"  "false"   "false"    2024/01/12      
# ℹ 704 more rows
# ℹ 166 more variables: fgfExclu &lt;chr&gt;, installExclu &lt;chr&gt;, matExclu &lt;chr&gt;,
#   moExclu &lt;chr&gt;, pourcAcompte1 &lt;chr&gt;, pourcAcompte2 &lt;chr&gt;, solde &lt;chr&gt;,
#   transportExclu &lt;chr&gt;, appNotifObligs &lt;chr&gt;, appNotifs &lt;chr&gt;,
#   codeClient2 &lt;chr&gt;, dateValidite &lt;chr&gt;, delaiPrevExped &lt;chr&gt;,
#   disclaimers &lt;chr&gt;, emplacementCre &lt;chr&gt;, enErreur &lt;chr&gt;, enPSD &lt;chr&gt;,
#   identCour &lt;chr&gt;, nbJourValide &lt;chr&gt;, nomClient &lt;chr&gt;, projet &lt;chr&gt;, …

$Etape
# A tibble: 2,439 × 6
   createur  dateCreation emplacement   statut tempsCreation    commande_id
   &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;            &lt;chr&gt;      
 1 dunintech 2023/08/30   Manufacturier Saisie 2023/08/30 10:48 C-000001   
 2 dunintech 2023/08/30   Manufacturier Saisie 2023/08/30 10:48 C-000001   
 3 dunintech 2023/08/30   Manufacturier Saisie 2023/08/30 10:48 C-000001   
 4 glebel    2023/08/31   Manufacturier Saisie 2023/08/31 09:11 C-000002   
 5 glebel    2023/08/31   Manufacturier Saisie 2023/08/31 09:11 C-000002   
 6 glebel    2023/08/31   Manufacturier Saisie 2023/08/31 09:11 C-000002   
 7 clientweb 2023/09/14   Client        Saisie 2023/09/14 07:53 C-000003   
 8 clientweb 2023/09/14   Client        Saisie 2023/09/14 07:53 C-000003   
 9 clientweb 2023/09/14   Client        Saisie 2023/09/14 07:53 C-000003   
10 clientweb 2023/09/14   Client        Saisie 2023/09/14 08:19 C-000004   
# ℹ 2,429 more rows

$SommaireKit
# A tibble: 7,317 × 7
   code     no    ligne  pourcEsc pourcEscSup sousTotal commande_id
   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      
 1 k01      1     Custom 0        0           346.43    C-000001   
 2 Contour  &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
 3 Plancher &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
 4 Plafond  &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
 5 k01      1     Custom 0        0           346.43    C-000001   
 6 Contour  &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
 7 Plancher &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
 8 Plafond  &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
 9 k01      1     Custom 0        0           346.43    C-000001   
10 Contour  &lt;NA&gt;  &lt;NA&gt;   0        0           0         C-000001   
# ℹ 7,307 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>commandes_xmls_extracted_tables<span class="sc">$</span>EveXML <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Kit
# A tibble: 958 × 128
   porteModeleB                porteModeleBSensGrain porteModeleFacadeBSensGrain
   &lt;chr&gt;                       &lt;chr&gt;                 &lt;chr&gt;                      
 1 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 2 &lt;NA&gt;                        &lt;NA&gt;                  sensGrain_Vert             
 3 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 4 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 5 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 6 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 7 Manufacturier~PLAT_16mm_MDF sensGrain_Vert        sensGrain_Vert             
 8 Manufacturier~PLAT_16mm_MDF sensGrain_Vert        sensGrain_Vert             
 9 Manufacturier~7053          sensGrain_Vert        sensGrain_Vert             
10 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
# ℹ 948 more rows
# ℹ 125 more variables: porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleH &lt;chr&gt;,
#   porteModeleHSensGrain &lt;chr&gt;, beamModele &lt;chr&gt;, moulLumHeight &lt;chr&gt;,
#   moulLumModele &lt;chr&gt;, moulPiedHeight &lt;chr&gt;, moulPiedModele &lt;chr&gt;,
#   sousTotalKit &lt;chr&gt;, typeColor &lt;chr&gt;, porteModeleFacadeB &lt;chr&gt;,
#   porteModeleFacadeH &lt;chr&gt;, cle &lt;chr&gt;, code &lt;chr&gt;, enErreur &lt;chr&gt;,
#   estExtra &lt;chr&gt;, no &lt;chr&gt;, nom &lt;chr&gt;, qte &lt;chr&gt;, qteTr &lt;chr&gt;, …

$KitMurContour
# A tibble: 658 × 119
   epais              porteModeleB  porteModeleBSensGrain porteModeleFacadeBSe…¹
   &lt;chr&gt;              &lt;chr&gt;         &lt;chr&gt;                 &lt;chr&gt;                 
 1 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
 2 152.39999999999998 &lt;NA&gt;          &lt;NA&gt;                  &lt;NA&gt;                  
 3 152.39999999999998 &lt;NA&gt;          &lt;NA&gt;                  &lt;NA&gt;                  
 4 152.39999999999998 &lt;NA&gt;          &lt;NA&gt;                  &lt;NA&gt;                  
 5 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
 6 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
 7 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
 8 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
 9 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
10 152.39999999999998 Manufacturie… sensGrain_Vert        sensGrain_Vert        
# ℹ 648 more rows
# ℹ abbreviated name: ¹​porteModeleFacadeBSensGrain
# ℹ 115 more variables: porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleH &lt;chr&gt;,
#   porteModeleHSensGrain &lt;chr&gt;, beamModele &lt;chr&gt;, moulLumHeight &lt;chr&gt;,
#   moulLumModele &lt;chr&gt;, moulPiedHeight &lt;chr&gt;, moulPiedModele &lt;chr&gt;,
#   sousTotalKit &lt;chr&gt;, typeColor &lt;chr&gt;, porteModeleFacadeB &lt;chr&gt;,
#   porteModeleFacadeH &lt;chr&gt;, enErreur &lt;chr&gt;, estExtra &lt;chr&gt;, qte &lt;chr&gt;, …

$KitPlancher
# A tibble: 626 × 117
   porteModeleB                porteModeleBSensGrain porteModeleFacadeBSensGrain
   &lt;chr&gt;                       &lt;chr&gt;                 &lt;chr&gt;                      
 1 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 2 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 3 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 4 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 5 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 6 Manufacturier~PLAT_16mm_MDF sensGrain_Vert        sensGrain_Vert             
 7 Manufacturier~PLAT_16mm_MDF sensGrain_Vert        sensGrain_Vert             
 8 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 9 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
10 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
# ℹ 616 more rows
# ℹ 114 more variables: porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleH &lt;chr&gt;,
#   porteModeleHSensGrain &lt;chr&gt;, beamModele &lt;chr&gt;, moulLumHeight &lt;chr&gt;,
#   moulLumModele &lt;chr&gt;, moulPiedHeight &lt;chr&gt;, moulPiedModele &lt;chr&gt;,
#   sousTotalKit &lt;chr&gt;, typeColor &lt;chr&gt;, porteModeleFacadeB &lt;chr&gt;,
#   porteModeleFacadeH &lt;chr&gt;, enErreur &lt;chr&gt;, estExtra &lt;chr&gt;, qte &lt;chr&gt;,
#   qteTr &lt;chr&gt;, aBomCustom &lt;chr&gt;, gTot &lt;chr&gt;, unit &lt;chr&gt;, …

$KitPlafond
# A tibble: 626 × 117
   porteModeleB                porteModeleBSensGrain porteModeleFacadeBSensGrain
   &lt;chr&gt;                       &lt;chr&gt;                 &lt;chr&gt;                      
 1 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 2 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 3 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 4 &lt;NA&gt;                        &lt;NA&gt;                  &lt;NA&gt;                       
 5 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 6 Manufacturier~PLAT_16mm_MDF sensGrain_Vert        sensGrain_Vert             
 7 Manufacturier~PLAT_16mm_MDF sensGrain_Vert        sensGrain_Vert             
 8 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
 9 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
10 Manufacturier~PLAT 16mm_MDF sensGrain_Vert        sensGrain_Vert             
# ℹ 616 more rows
# ℹ 114 more variables: porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleH &lt;chr&gt;,
#   porteModeleHSensGrain &lt;chr&gt;, beamModele &lt;chr&gt;, moulLumHeight &lt;chr&gt;,
#   moulLumModele &lt;chr&gt;, moulPiedHeight &lt;chr&gt;, moulPiedModele &lt;chr&gt;,
#   sousTotalKit &lt;chr&gt;, typeColor &lt;chr&gt;, porteModeleFacadeB &lt;chr&gt;,
#   porteModeleFacadeH &lt;chr&gt;, enErreur &lt;chr&gt;, estExtra &lt;chr&gt;, qte &lt;chr&gt;,
#   qteTr &lt;chr&gt;, aBomCustom &lt;chr&gt;, gTot &lt;chr&gt;, unit &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="contrats" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="contrats"><span class="header-section-number">8.2</span> Contrats</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>contrats_xmls_extracted_tables<span class="sc">$</span>DocumXML <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Contrat
# A tibble: 3,104 × 155
   codeClient2 dateValidite delaiPrevExped emplacementCre identCour nbJourValide
   &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;       
 1 ALaplante   2025/03/10   2              Interne        0         60          
 2 ABrealt     2025/04/12   2              Interne        0         &lt;NA&gt;        
 3 ACloutier   &lt;NA&gt;         2              Interne        0         60          
 4 RBouchard   2025/04/25   2              Interne        0         60          
 5 ABrealt     2025/05/27   2              Interne        0         &lt;NA&gt;        
 6 ALaplante   2025/04/10   2              Interne        0         60          
 7 ABrealt     2025/04/08   2              Interne        0         &lt;NA&gt;        
 8 CRobitaille 2025/03/10   2              Interne        0         60          
 9 ABrealt     2025/04/08   2              Interne        0         &lt;NA&gt;        
10 ALaplante   2025/03/27   2              Interne        0         60          
# ℹ 3,094 more rows
# ℹ 149 more variables: nomClient &lt;chr&gt;, projet &lt;chr&gt;, promotions &lt;chr&gt;,
#   qteItems &lt;chr&gt;, qteItemsCab &lt;chr&gt;, roleProprietaire &lt;chr&gt;, sorte &lt;chr&gt;,
#   type &lt;chr&gt;, typeClient &lt;chr&gt;, typeProcess &lt;chr&gt;, validCred &lt;chr&gt;,
#   ligne &lt;chr&gt;, cleEnMain &lt;chr&gt;, installateur &lt;chr&gt;, installation &lt;chr&gt;,
#   priseMesure &lt;chr&gt;, assemblage &lt;chr&gt;, edgeColle &lt;chr&gt;, gamme &lt;chr&gt;,
#   cleItem &lt;chr&gt;, createurCourriel &lt;chr&gt;, createurNom &lt;chr&gt;, …

$Disclaimer
# A tibble: 19,227 × 5
   condition terme           contrat_id  termeImage termeDescrip
   &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;       
 1 ""        PriseMesure_100 P-000390-S1 &lt;NA&gt;       &lt;NA&gt;        
 2 ""        Electro_90      P-000390-S1 &lt;NA&gt;       &lt;NA&gt;        
 3 ""        PriseMesure_100 P-000390-S1 &lt;NA&gt;       &lt;NA&gt;        
 4 ""        Electro_90      P-000390-S1 &lt;NA&gt;       &lt;NA&gt;        
 5 ""        PriseMesure_100 P-000390-S1 &lt;NA&gt;       &lt;NA&gt;        
 6 ""        Electro_90      P-000390-S1 &lt;NA&gt;       &lt;NA&gt;        
 7 ""        PriseMesure_100 P-000390-S2 &lt;NA&gt;       &lt;NA&gt;        
 8 ""        Electro_90      P-000390-S2 &lt;NA&gt;       &lt;NA&gt;        
 9 ""        Contrainte_10_1 P-000390-S2 &lt;NA&gt;       &lt;NA&gt;        
10 ""        Comptoir_02_1   P-000390-S2 &lt;NA&gt;       &lt;NA&gt;        
# ℹ 19,217 more rows

$Etape
# A tibble: 9,225 × 6
   createur            dateCreation emplacement  statut tempsCreation contrat_id
   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;     
 1 alaplante           2025/01/09   Manufacturi… Saisie 2025/01/09 1… P-000390-…
 2 alaplante           2025/01/09   Manufacturi… Saisie 2025/01/09 1… P-000390-…
 3 alaplante           2025/01/09   Manufacturi… Saisie 2025/01/09 1… P-000390-…
 4 abreault            2025/01/13   Manufacturi… Saisie 2025/01/13 1… P-000390-…
 5 abreault            2025/01/13   Manufacturi… Saisie 2025/01/13 1… P-000390-…
 6 abreault            2025/01/13   Manufacturi… Saisie 2025/01/13 1… P-000390-…
 7 abreault            2025/02/25   Manufacturi… Saisie 2025/02/25 0… P-000554-…
 8 abreault            2025/02/25   Manufacturi… Saisie 2025/02/25 0… P-000554-…
 9 abreault            2025/02/25   Manufacturi… Saisie 2025/02/25 0… P-000554-…
10 rbouchard@avivia.ca 2025/02/25   Manufacturi… Saisie 2025/02/25 1… P-000715-…
# ℹ 9,215 more rows

$SommaireKit
# A tibble: 37,983 × 7
   code  no    ligne  pourcEsc pourcEscSup sousTotal contrat_id 
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      
 1 k01   1     Custom 0        0           8885.54   P-000390-S1
 2 k02   2     Custom 0        0           4085.66   P-000390-S1
 3 k01   1     Custom 0        0           8885.54   P-000390-S1
 4 k02   2     Custom 0        0           4085.66   P-000390-S1
 5 k01   1     Custom 0        0           8885.54   P-000390-S1
 6 k02   2     Custom 0        0           4085.66   P-000390-S1
 7 k01   3     Custom 0        0           1048.6    P-000390-S2
 8 k02   2     Custom 0        0           2340.31   P-000390-S2
 9 k01   &lt;NA&gt;  &lt;NA&gt;   0        0           &lt;NA&gt;      P-000390-S2
10 k01   3     Custom 0        0           1048.6    P-000390-S2
# ℹ 37,973 more rows

$Lumiere
# A tibble: 2,826 × 3
   modele       qte   contrat_id 
   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;      
 1 PUCK120mm_NI 2     P-000390-S1
 2 PUCK79mm_NI  5     P-000390-S1
 3 PUCK120mm_NI 2     P-000390-S1
 4 PUCK79mm_NI  5     P-000390-S1
 5 PUCK120mm_NI 2     P-000390-S1
 6 PUCK79mm_NI  5     P-000390-S1
 7 PUCK79mm_WH  4     P-000390-S2
 8 PUCK79mm_WH  4     P-000390-S2
 9 PUCK79mm_WH  4     P-000390-S2
10 PUCK79mm_WH  4     P-000554-S1
# ℹ 2,816 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>contrats_xmls_extracted_tables<span class="sc">$</span>EveXML <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$KitMurContour
# A tibble: 3,078 × 119
   epais      t_epais nom   gTot  unit  cost_fgfCumul cost_matCumul cost_moCumul
   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;       
 1 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 2 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 3 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 4 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 5 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 6 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 7 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 8 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
 9 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
10 152.39999… "6\""   Cont… ***   ***   ***           ***           ***         
# ℹ 3,068 more rows
# ℹ 111 more variables: price_fgfCumul &lt;chr&gt;, price_matCumul &lt;chr&gt;,
#   price_moCumul &lt;chr&gt;, contrat_id &lt;chr&gt;, qte &lt;chr&gt;, cumulComptoir &lt;chr&gt;,
#   totalComptoir &lt;chr&gt;, porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;,
#   porteModeleB_epais &lt;chr&gt;, t_porteModeleB_epais &lt;chr&gt;,
#   porteModeleFacadeBSensGrain &lt;chr&gt;, porteModeleFacadeB_epais &lt;chr&gt;,
#   t_porteModeleFacadeB_epais &lt;chr&gt;, porteModeleFacadeHSensGrain &lt;chr&gt;, …

$KitMur
# A tibble: 1,464 × 22
   epais       t_epais nom   qte   contrat_id aBomCustom enErreur estExtra unit 
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;
 1 152.399999… "6\""   Mur   1     P-000390-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 2 152.399999… "6\""   Mur   1     P-000390-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 3 152.399999… "6\""   Mur   1     P-000554-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 4 152.399999… "6\""   Mur   1     P-000715-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 5 152.399999… "6\""   Mur   1     P-000715-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 6 152.399999… "6\""   Mur   1     P-000773-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 7 152.399999… "6\""   Mur   1     P-000828-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 8 152.399999… "6\""   Mur   1     P-000907-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 9 152.399999… "6\""   Mur   1     P-000907-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
10 152.399999… "6\""   Mur   1     P-000907-… &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
# ℹ 1,454 more rows
# ℹ 13 more variables: moulLumHeight &lt;chr&gt;, t_moulLumHeight &lt;chr&gt;,
#   beamHeight &lt;chr&gt;, t_beamHeight &lt;chr&gt;, code &lt;chr&gt;, gTot &lt;chr&gt;,
#   cost_fgfCumul &lt;chr&gt;, cost_matCumul &lt;chr&gt;, cost_moCumul &lt;chr&gt;,
#   price_fgfCumul &lt;chr&gt;, price_matCumul &lt;chr&gt;, price_moCumul &lt;chr&gt;,
#   items &lt;chr&gt;

$KitMuret
# A tibble: 1,551 × 113
   epais   t_epais haut  t_haut nom   qte   contrat_id cle   aBomCustom enErreur
   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;   
 1 152.39… "6\""   914.… "36\"" Muret 1     P-000390-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 2 152.39… "6\""   914.… "36\"" Muret 1     P-000390-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 3 152.39… "6\""   914.… "36\"" Muret 1     P-000554-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 4 152.39… "6\""   914.… "36\"" Muret 1     P-000715-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 5 152.39… "6\""   914.… "36\"" Muret 1     P-000715-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 6 152.39… "6\""   914.… "36\"" Muret 1     P-000773-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 7 152.39… "6\""   914.… "36\"" Muret 1     P-000828-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 8 152.39… "6\""   914.… "36\"" Muret 1     P-000907-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
 9 152.39… "6\""   914.… "36\"" Muret 1     P-000907-… &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;    
10 152.39… "6\""   914.… "36\"" Muret &lt;NA&gt;  P-000907-… 199   &lt;NA&gt;       &lt;NA&gt;    
# ℹ 1,541 more rows
# ℹ 103 more variables: estExtra &lt;chr&gt;, unit &lt;chr&gt;, estBloqPrix &lt;chr&gt;,
#   sousTotal &lt;chr&gt;, sousTotalAutre &lt;chr&gt;, sousTotalCab &lt;chr&gt;,
#   sousTotalEff &lt;chr&gt;, sousTotalMoulure &lt;chr&gt;, sousTotalPanel &lt;chr&gt;,
#   sousTotalKitEff &lt;chr&gt;, porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;,
#   porteModeleB_epais &lt;chr&gt;, t_porteModeleB_epais &lt;chr&gt;,
#   porteModeleFacadeBSensGrain &lt;chr&gt;, porteModeleFacadeB_epais &lt;chr&gt;, …

$KitRetombee
# A tibble: 1,512 × 106
   epais         t_epais haut  t_haut nom   qte   contrat_id aBomCustom enErreur
   &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;   
 1 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000390-… &lt;NA&gt;       &lt;NA&gt;    
 2 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000390-… &lt;NA&gt;       &lt;NA&gt;    
 3 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000554-… &lt;NA&gt;       &lt;NA&gt;    
 4 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000715-… &lt;NA&gt;       &lt;NA&gt;    
 5 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000715-… &lt;NA&gt;       &lt;NA&gt;    
 6 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000773-… &lt;NA&gt;       &lt;NA&gt;    
 7 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000828-… &lt;NA&gt;       &lt;NA&gt;    
 8 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000907-… &lt;NA&gt;       &lt;NA&gt;    
 9 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000907-… &lt;NA&gt;       &lt;NA&gt;    
10 152.39999999… "6\""   914.… "36\"" Reto… 1     P-000907-… &lt;NA&gt;       &lt;NA&gt;    
# ℹ 1,502 more rows
# ℹ 97 more variables: estExtra &lt;chr&gt;, unit &lt;chr&gt;, estBloqPrix &lt;chr&gt;,
#   sousTotal &lt;chr&gt;, sousTotalAutre &lt;chr&gt;, sousTotalCab &lt;chr&gt;,
#   sousTotalEff &lt;chr&gt;, sousTotalMoulure &lt;chr&gt;, sousTotalPanel &lt;chr&gt;,
#   sousTotalKitEff &lt;chr&gt;, porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;,
#   porteModeleB_epais &lt;chr&gt;, t_porteModeleB_epais &lt;chr&gt;,
#   porteModeleFacadeBSensGrain &lt;chr&gt;, porteModeleFacadeB_epais &lt;chr&gt;, …

$KitMurOuvert
# A tibble: 1,441 × 7
   nom    qte   contrat_id  aBomCustom enErreur estExtra unit 
   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;
 1 Ouvert 1     P-000390-S1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 2 Ouvert 1     P-000390-S2 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 3 Ouvert 1     P-000554-S1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 4 Ouvert 1     P-000715-S1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 5 Ouvert 1     P-000715-S2 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 6 Ouvert 1     P-000773-S1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 7 Ouvert 1     P-000828-S1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 8 Ouvert 1     P-000907-S1 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
 9 Ouvert 1     P-000907-S2 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
10 Ouvert 1     P-000907-S3 &lt;NA&gt;       &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; 
# ℹ 1,431 more rows

$KitPlancher
# A tibble: 3,037 × 117
   nom      gTot  unit  cost_fgfCumul cost_matCumul cost_moCumul price_fgfCumul
   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;         
 1 Plancher ***   ***   ***           ***           ***          ***           
 2 Plancher ***   ***   ***           ***           ***          ***           
 3 Plancher ***   ***   ***           ***           ***          ***           
 4 Plancher ***   ***   ***           ***           ***          ***           
 5 Plancher ***   ***   ***           ***           ***          ***           
 6 Plancher ***   ***   ***           ***           ***          ***           
 7 Plancher ***   ***   ***           ***           ***          ***           
 8 Plancher ***   ***   ***           ***           ***          ***           
 9 Plancher ***   ***   ***           ***           ***          ***           
10 Plancher ***   ***   ***           ***           ***          ***           
# ℹ 3,027 more rows
# ℹ 110 more variables: price_matCumul &lt;chr&gt;, price_moCumul &lt;chr&gt;,
#   contrat_id &lt;chr&gt;, qte &lt;chr&gt;, cumulComptoir &lt;chr&gt;, totalComptoir &lt;chr&gt;,
#   porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;, porteModeleB_epais &lt;chr&gt;,
#   t_porteModeleB_epais &lt;chr&gt;, porteModeleFacadeBSensGrain &lt;chr&gt;,
#   porteModeleFacadeB_epais &lt;chr&gt;, t_porteModeleFacadeB_epais &lt;chr&gt;,
#   porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleFacadeH_epais &lt;chr&gt;, …

$KitPlafond
# A tibble: 3,037 × 117
   nom     gTot  unit  cost_fgfCumul cost_matCumul cost_moCumul price_fgfCumul
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;         
 1 Plafond ***   ***   ***           ***           ***          ***           
 2 Plafond ***   ***   ***           ***           ***          ***           
 3 Plafond ***   ***   ***           ***           ***          ***           
 4 Plafond ***   ***   ***           ***           ***          ***           
 5 Plafond ***   ***   ***           ***           ***          ***           
 6 Plafond ***   ***   ***           ***           ***          ***           
 7 Plafond ***   ***   ***           ***           ***          ***           
 8 Plafond ***   ***   ***           ***           ***          ***           
 9 Plafond ***   ***   ***           ***           ***          ***           
10 Plafond ***   ***   ***           ***           ***          ***           
# ℹ 3,027 more rows
# ℹ 110 more variables: price_matCumul &lt;chr&gt;, price_moCumul &lt;chr&gt;,
#   contrat_id &lt;chr&gt;, qte &lt;chr&gt;, cumulComptoir &lt;chr&gt;, totalComptoir &lt;chr&gt;,
#   porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;, porteModeleB_epais &lt;chr&gt;,
#   t_porteModeleB_epais &lt;chr&gt;, porteModeleFacadeBSensGrain &lt;chr&gt;,
#   porteModeleFacadeB_epais &lt;chr&gt;, t_porteModeleFacadeB_epais &lt;chr&gt;,
#   porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleFacadeH_epais &lt;chr&gt;, …

$KitElemDeco
# A tibble: 820 × 101
   cle   nom         qte   contrat_id  estBloqPrix sousTotal sousTotalAutre
   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;         
 1 121   KitElemDeco ""    P-000390-S1 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 2 506   KitElemDeco ""    P-000390-S2 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 3 844   KitElemDeco ""    P-000554-S1 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 4 477   KitElemDeco ""    P-000715-S1 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 5 566   KitElemDeco ""    P-000715-S2 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 6 30    KitElemDeco ""    P-000773-S1 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 7 246   KitElemDeco ""    P-000828-S1 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 8 29    KitElemDeco ""    P-000907-S2 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
 9 86    KitElemDeco ""    P-000907-S4 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
10 506   KitElemDeco ""    P-000907-S5 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;          
# ℹ 810 more rows
# ℹ 94 more variables: sousTotalCab &lt;chr&gt;, sousTotalEff &lt;chr&gt;,
#   sousTotalMoulure &lt;chr&gt;, sousTotalPanel &lt;chr&gt;, sousTotalKitEff &lt;chr&gt;,
#   porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;, porteModeleB_epais &lt;chr&gt;,
#   t_porteModeleB_epais &lt;chr&gt;, porteModeleFacadeBSensGrain &lt;chr&gt;,
#   porteModeleFacadeB_epais &lt;chr&gt;, t_porteModeleFacadeB_epais &lt;chr&gt;,
#   porteModeleFacadeHSensGrain &lt;chr&gt;, porteModeleFacadeH_epais &lt;chr&gt;, …

$Kit
# A tibble: 5,694 × 128
   cumulComptoir extraComptoir nbComptoir sousTotal sousTotalCab sousTotalEff
   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;       
 1 6718.4        100           5          8885.54   8260.83      8885.54     
 2 &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;       4085.66   3904.57      4085.66     
 3 2436          &lt;NA&gt;          2          6778.44   6158.02      6778.44     
 4 1352.4        &lt;NA&gt;          1          2340.31   2134.74      2340.31     
 5 108.49        &lt;NA&gt;          1          1048.6    947.91       1048.6      
 6 &lt;NA&gt;          100           2          7254.23   6417.55      7254.23     
 7 &lt;NA&gt;          &lt;NA&gt;          1          6036.33   5702.66      6036.33     
 8 &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;       1455.81   1250.4       1455.81     
 9 2112          &lt;NA&gt;          1          3872.74   3708.65      3872.74     
10 706.8         &lt;NA&gt;          2          4953.08   4211.03      4953.08     
# ℹ 5,684 more rows
# ℹ 122 more variables: sousTotalMoulure &lt;chr&gt;, sousTotalPanel &lt;chr&gt;,
#   totalComptoir &lt;chr&gt;, totalComptoirEff &lt;chr&gt;, sousTotalKitEff &lt;chr&gt;,
#   longComptoir &lt;chr&gt;, porteModeleB &lt;chr&gt;, porteModeleBSensGrain &lt;chr&gt;,
#   porteModeleB_epais &lt;chr&gt;, t_porteModeleB_epais &lt;chr&gt;,
#   porteModeleFacadeB_epais &lt;chr&gt;, t_porteModeleFacadeB_epais &lt;chr&gt;,
#   porteModeleFacadeH_epais &lt;chr&gt;, t_porteModeleFacadeH_epais &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="projets" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="projets"><span class="header-section-number">8.3</span> Projets</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>projets_xmls_extracted_tables<span class="sc">$</span>ProjetXMLS <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
</section>
<section id="modèle-de-données-résultant" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Modèle de données résultant</h1>
<section id="tables-principales" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="tables-principales"><span class="header-section-number">9.1</span> Tables principales</h2>
<ul>
<li><p><em>Table PROJETS</em></p>
<p>Clé primaire : code Données : Informations client, représentant, coordonnées de contact Usage : Table de référence pour les commandes et contrats</p></li>
<li><p><em>Table COMMANDES</em></p>
<p>Clé primaire : code Clé étrangère : projet (référence vers PROJETS) Données : Informations commerciales, montants, taxes, statuts</p></li>
<li><p><em>Table CONTRATS</em></p>
<p>Clé primaire : contrat_id Clé étrangère : projet (référence vers PROJETS) Données : Détails contractuels, comptoirs spécialisés, frais</p></li>
<li><p><em>Table KITS</em> (ensemble : kits , kitMur , etc…)</p>
<p>Clés étrangères : commande_id, contrat_id Données : Spécifications techniques détaillées des éléments (armoires, comptoirs, etc.)</p></li>
<li><p><em>Tables support</em></p>
<p>ADRESSES : Coordonnées géographiques liées aux projets ETAPES : Suivi du workflow des commandes/contrats</p>
<p>LUMIERES : Éléments d’éclairage associés</p></li>
</ul>
</section>
<section id="modèle-relationnelle-des-données-extraites" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="modèle-relationnelle-des-données-extraites"><span class="header-section-number">9.2</span> Modèle relationnelle des données extraites</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="672" height="480" viewbox="0.00 0.00 694.36 259.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 255)">
<title>BaseDonnees</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-255 690.36,-255 690.36,4 -4,4"></polygon>
<!-- PROJETS -->
<g id="node1" class="node">
<title>PROJETS</title>
<polygon fill="lightgrey" stroke="black" points="0,-64.3 0,-100.3 137.4,-100.3 137.4,-64.3 0,-64.3"></polygon>
<text text-anchor="middle" x="36.79" y="-78.2" font-family="Times,serif" font-size="14.00">PROJETS</text>
<polyline fill="none" stroke="black" points="73.57,-64.5 73.57,-100.3 "></polyline>
<text text-anchor="middle" x="105.48" y="-78.2" font-family="Times,serif" font-size="14.00">code PK</text>
</g>
<!-- COMMANDES -->
<g id="node2" class="node">
<title>COMMANDES</title>
<polygon fill="lightgrey" stroke="black" points="222,-61.5 222,-103.1 399.07,-103.1 399.07,-61.5 222,-61.5"></polygon>
<text text-anchor="middle" x="275.51" y="-78.1" font-family="Times,serif" font-size="14.00">COMMANDES</text>
<polyline fill="none" stroke="black" points="329.01,-61.5 329.01,-103.1 "></polyline>
<text text-anchor="start" x="337.01" y="-86.5" font-family="Times,serif" font-size="14.00">code PK</text>
<text text-anchor="middle" x="364.04" y="-69.7" font-family="Times,serif" font-size="14.00">projet FK</text>
</g>
<!-- PROJETS&#45;&gt;COMMANDES -->
<g id="edge1" class="edge">
<title>PROJETS-&gt;COMMANDES</title>
<path fill="none" stroke="black" d="M137.46,-82.3C160.47,-82.3 186.66,-82.3 211.55,-82.3"></path>
<polygon fill="black" stroke="black" points="211.75,-85.8 221.75,-82.3 211.75,-78.8 211.75,-85.8"></polygon>
<text text-anchor="middle" x="177.95" y="-86.5" font-family="Times,serif" font-size="14.00">contient</text>
</g>
<!-- CONTRATS -->
<g id="node3" class="node">
<title>CONTRATS</title>
<polygon fill="lightgrey" stroke="black" points="218.51,-151.5 218.51,-193.1 402.56,-193.1 402.56,-151.5 218.51,-151.5"></polygon>
<text text-anchor="middle" x="263.46" y="-168.1" font-family="Times,serif" font-size="14.00">CONTRATS</text>
<polyline fill="none" stroke="black" points="308.4,-151.5 308.4,-193.1 "></polyline>
<text text-anchor="start" x="316.4" y="-176.5" font-family="Times,serif" font-size="14.00">contrat_id PK</text>
<text text-anchor="middle" x="355.48" y="-159.7" font-family="Times,serif" font-size="14.00">projet FK</text>
</g>
<!-- PROJETS&#45;&gt;CONTRATS -->
<g id="edge2" class="edge">
<title>PROJETS-&gt;CONTRATS</title>
<path fill="none" stroke="black" d="M117.94,-100.4C154.29,-114.04 204.51,-132.89 244.41,-147.86"></path>
<polygon fill="black" stroke="black" points="243.21,-151.15 253.8,-151.39 245.67,-144.59 243.21,-151.15"></polygon>
<text text-anchor="middle" x="177.95" y="-133.5" font-family="Times,serif" font-size="14.00">contient</text>
</g>
<!-- ADRESSES -->
<g id="node4" class="node">
<title>ADRESSES</title>
<polygon fill="lightgrey" stroke="black" points="223.55,-0.5 223.55,-42.1 397.51,-42.1 397.51,-0.5 223.55,-0.5"></polygon>
<text text-anchor="middle" x="266.56" y="-17.1" font-family="Times,serif" font-size="14.00">ADRESSES</text>
<polyline fill="none" stroke="black" points="309.57,-0.5 309.57,-42.1 "></polyline>
<text text-anchor="start" x="317.57" y="-25.5" font-family="Times,serif" font-size="14.00">code PK</text>
<text text-anchor="middle" x="353.54" y="-8.7" font-family="Times,serif" font-size="14.00">projet_id FK</text>
</g>
<!-- PROJETS&#45;&gt;ADRESSES -->
<g id="edge3" class="edge">
<title>PROJETS-&gt;ADRESSES</title>
<path fill="none" stroke="black" d="M137.46,-65.06C162.38,-58.73 191.04,-51.44 217.72,-44.65"></path>
<polygon fill="black" stroke="black" points="218.62,-48.03 227.45,-42.18 216.9,-41.25 218.62,-48.03"></polygon>
<text text-anchor="middle" x="177.95" y="-63.5" font-family="Times,serif" font-size="14.00">possède</text>
</g>
<!-- KITS -->
<g id="node5" class="node">
<title>KITS</title>
<polygon fill="lightgrey" stroke="black" points="503.1,-109.1 503.1,-167.5 666.92,-167.5 666.92,-109.1 503.1,-109.1"></polygon>
<text text-anchor="middle" x="526.66" y="-134.1" font-family="Times,serif" font-size="14.00">KITS</text>
<polyline fill="none" stroke="black" points="550.21,-109.1 550.21,-167.5 "></polyline>
<text text-anchor="start" x="558.21" y="-150.9" font-family="Times,serif" font-size="14.00">code PK</text>
<text text-anchor="start" x="558.21" y="-134.1" font-family="Times,serif" font-size="14.00">commande_id FK</text>
<text text-anchor="middle" x="608.56" y="-117.3" font-family="Times,serif" font-size="14.00">contrat_id FK</text>
</g>
<!-- COMMANDES&#45;&gt;KITS -->
<g id="edge6" class="edge">
<title>COMMANDES-&gt;KITS</title>
<path fill="none" stroke="black" d="M381.59,-61.45C408.88,-56.99 439.76,-56.66 465.66,-68.5 476.77,-73.58 473.97,-81.84 483.66,-89.3 490.45,-94.53 497.89,-99.41 505.55,-103.91"></path>
<polygon fill="black" stroke="black" points="504.18,-107.16 514.61,-109.02 507.62,-101.06 504.18,-107.16"></polygon>
<text text-anchor="middle" x="443.11" y="-73.5" font-family="Times,serif" font-size="14.00">contient</text>
</g>
<!-- ETAPES -->
<g id="node6" class="node">
<title>ETAPES</title>
<polygon fill="lightgrey" stroke="black" points="492.99,-192.1 492.99,-250.5 677.03,-250.5 677.03,-192.1 492.99,-192.1"></polygon>
<text text-anchor="middle" x="526.66" y="-217.1" font-family="Times,serif" font-size="14.00">ETAPES</text>
<polyline fill="none" stroke="black" points="560.32,-192.1 560.32,-250.5 "></polyline>
<text text-anchor="start" x="568.32" y="-233.9" font-family="Times,serif" font-size="14.00">id PK</text>
<text text-anchor="start" x="568.32" y="-217.1" font-family="Times,serif" font-size="14.00">commande_id FK</text>
<text text-anchor="middle" x="618.68" y="-200.3" font-family="Times,serif" font-size="14.00">contrat_id FK</text>
</g>
<!-- COMMANDES&#45;&gt;ETAPES -->
<g id="edge4" class="edge">
<title>COMMANDES-&gt;ETAPES</title>
<path fill="none" stroke="black" d="M364.45,-103.18C408.23,-120.52 463.58,-142.66 465.66,-144.5 478.09,-155.54 471.39,-166.07 483.66,-177.3 487.24,-180.58 491.11,-183.64 495.16,-186.5"></path>
<polygon fill="black" stroke="black" points="493.44,-189.55 503.73,-192.08 497.26,-183.69 493.44,-189.55"></polygon>
<text text-anchor="middle" x="443.11" y="-148.5" font-family="Times,serif" font-size="14.00">suit</text>
</g>
<!-- LUMIERES -->
<g id="node7" class="node">
<title>LUMIERES</title>
<polygon fill="lightgrey" stroke="black" points="483.66,-21.1 483.66,-79.5 686.36,-79.5 686.36,-21.1 483.66,-21.1"></polygon>
<text text-anchor="middle" x="526.66" y="-46.1" font-family="Times,serif" font-size="14.00">LUMIERES</text>
<polyline fill="none" stroke="black" points="569.66,-21.1 569.66,-79.5 "></polyline>
<text text-anchor="start" x="577.66" y="-62.9" font-family="Times,serif" font-size="14.00">id PK</text>
<text text-anchor="start" x="577.66" y="-46.1" font-family="Times,serif" font-size="14.00">commande_id FK</text>
<text text-anchor="middle" x="628.01" y="-29.3" font-family="Times,serif" font-size="14.00">contrat_id FK</text>
</g>
<!-- COMMANDES&#45;&gt;LUMIERES -->
<g id="edge8" class="edge">
<title>COMMANDES-&gt;LUMIERES</title>
<path fill="none" stroke="black" d="M385.4,-61.34C391.43,-58.39 397.24,-55.06 402.56,-51.3 413.1,-43.85 408.94,-34.13 420.56,-28.5 441.75,-18.23 466.19,-16.81 489.62,-19.61"></path>
<polygon fill="black" stroke="black" points="489.18,-23.09 499.58,-21.06 490.19,-16.16 489.18,-23.09"></polygon>
<text text-anchor="middle" x="443.11" y="-33.5" font-family="Times,serif" font-size="14.00">contient</text>
</g>
<!-- CONTRATS&#45;&gt;KITS -->
<g id="edge7" class="edge">
<title>CONTRATS-&gt;KITS</title>
<path fill="none" stroke="black" d="M402.64,-170.86C423.42,-169.79 445.35,-168.05 465.66,-165.3 474.55,-164.09 483.76,-162.54 492.94,-160.79"></path>
<polygon fill="black" stroke="black" points="493.74,-164.2 502.87,-158.82 492.38,-157.33 493.74,-164.2"></polygon>
<text text-anchor="middle" x="443.11" y="-173.5" font-family="Times,serif" font-size="14.00">contient</text>
</g>
<!-- CONTRATS&#45;&gt;ETAPES -->
<g id="edge5" class="edge">
<title>CONTRATS-&gt;ETAPES</title>
<path fill="none" stroke="black" d="M402.64,-188.68C428.43,-193.32 456.66,-198.4 482.99,-203.13"></path>
<polygon fill="black" stroke="black" points="482.52,-206.61 492.99,-204.93 483.76,-199.72 482.52,-206.61"></polygon>
<text text-anchor="middle" x="443.11" y="-203.5" font-family="Times,serif" font-size="14.00">suit</text>
</g>
<!-- CONTRATS&#45;&gt;LUMIERES -->
<g id="edge9" class="edge">
<title>CONTRATS-&gt;LUMIERES</title>
<path fill="none" stroke="black" d="M343.59,-151.39C364.87,-138.06 393.72,-121 420.56,-108.5 440.33,-99.29 462,-90.64 482.9,-82.96"></path>
<polygon fill="black" stroke="black" points="484.23,-86.2 492.44,-79.5 481.85,-79.62 484.23,-86.2"></polygon>
<text text-anchor="middle" x="443.11" y="-112.5" font-family="Times,serif" font-size="14.00">contient</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
<section id="dictionnaire-de-données-sélectionnées" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Dictionnaire de données sélectionnées</h1>
<section id="table-commandes" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="table-commandes"><span class="header-section-number">10.1</span> table commandes</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-1728fce5f60d0891598f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1728fce5f60d0891598f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34"],["code","nomClient","codeClient2","typeClient","dateCreation","dateValidite","datePrevExped","delaiPrevExped","nbJourValide","statutCred","validCred","total","totalHT","sousTotal","sousTotal2","totalLivraison","totalInstall","totalCEM","qteItems","qteItemsCab","promotions","createurNom","createurCourriel","division","projet","estImport","estReprise","estCQ","avecLivraison","installation","totalTx1","totalTx2","ecartPrix","solde"],[["Code de la commande"],["Nom du client"],["Code client"],["Type de client"],["Date de création de la commande"],["Date de validité de l’offre"],["Date d’expédition prévue"],["Délai d’expédition prévu (jours)"],["Nombre de jours de validité restants"],["Statut crédit"],["Validation crédit"],["Total TTC de la commande"],["Total HT de la commande"],["Sous-total général"],["Sous-total intermédiaire (avec ajustements)"],["Montant livraison"],["Montant installation"],["Montant CEM"],["Quantité totale d’articles"],["Quantité d’articles en cabine"],["Promotions appliquées"],["Nom du créateur de la commande"],["Courriel du créateur"],["Division commerciale"],["Nom du projet"],["Est une commande importée"],["Est une reprise"],["Contrôle qualité supérieur"],["Avec livraison"],["Avec installation"],["Montant taxe 1"],["Montant taxe 2"],["Écart de prix"],["Montant du solde"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-contrats" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="table-contrats"><span class="header-section-number">10.2</span> table contrats</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cb78073691c70aa6241d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cb78073691c70aa6241d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["code","codeClient2","nomClient","typeClient","dateCreation","dateValidite","datePrevExped","delaiPrevExped","nbJourValide","statutCred","validCred","projet","division","promotions","qteItems","qteItemsCab","total","totalHT","sousTotal","sousTotal2","totalLivraison","totalInstall","totalComptoirBois","totalComptoirGranite","totalComptoirQuartz","totalComptoirStratifie","totalEsc","ecartPrix","montantEcartPrix","fraisPSD","fraisPDM","fraisSAV","TotalEscompte","avecLivraison","installation","createurNom","createurCourriel","codePost","codePostFinal","estReprise"],[["Code du contrat"],["Code client"],["Nom du client"],["Type de client"],["Date de création du contrat"],["Date de validité de l’offre"],["Date d’expédition prévue"],["Délai d’expédition prévu (jours)"],["Nombre de jours de validité restants"],["Statut crédit"],["Validation crédit"],["Nom du projet"],["Division commerciale"],["Promotions appliquées"],["Quantité totale d’articles"],["Quantité d’articles en cabine"],["Total TTC du contrat"],["Total HT du contrat"],["Sous-total général"],["Sous-total intermédiaire (avec ajustements)"],["Montant livraison"],["Montant installation"],["Total comptoir bois"],["Total comptoir granite"],["Total comptoir quartz"],["Total comptoir stratifié"],["Total escaliers"],["Écart de prix"],["Montant écart de prix"],["Frais PSD"],["Frais prise de mesure"],["Frais SAV"],["Montant total escompte"],["Avec livraison"],["Avec installation"],["Nom du créateur"],["Courriel du créateur"],["Code postal chantier"],["Code postal livraison finale"],["Est une reprise"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-projets" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="table-projets"><span class="header-section-number">10.3</span> table projets</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2f3008ec9ae2e8e82b87" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2f3008ec9ae2e8e82b87">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18"],["code","client","marche","codeRepresentant","nomRepresentant","dateCreation","division","ciClient","courrielContact","nomContact","telephoneContact","coordsCommTxt","coordsExpedTxt","coordsFactTxt","estReprise","enFusion","createurNom","createurCourriel"],[["Code du document / BL"],["Nom du client"],["Marché / pays"],["Code représentant"],["Nom représentant"],["Date de création"],["Division commerciale"],["Code installation client"],["Courriel du contact"],["Nom du contact"],["Téléphone du contact"],["Adresse de commande (texte)"],["Adresse d’expédition (texte)"],["Adresse de facturation (texte)"],["Est une reprise"],["En fusion"],["Nom du créateur"],["Courriel du créateur"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-kits-kit-kitmur-kitplafond." class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="table-kits-kit-kitmur-kitplafond."><span class="header-section-number">10.4</span> table kits { kit , kitMur , KitPlafond,….}</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cc81938a01733a70106a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cc81938a01733a70106a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113"],["code","nom","qte","qteTr","typeKit","unit","sousTotalKit","sousTotalKitEff","sousTotal","sousTotalEff","totalComptoir","totalComptoirEff","nbComptoir","longComptoir","surfaceComptoir","cumulComptoir","extraComptoir","comptoirMod","comptoirCouleur","comptoirGpCouleur","sousTotalCab","sousTotalPanel","sousTotalMoulure","sousTotalAutre","assemblage","gamme","serie","finishColor","edgeColle","edgeBanding","bd_edgeBanding","df_edgeBanding","wd_edgeBanding","edgePorte","edgeTablette","handle","handleOri","bd_handle","bd_handleOri","df_handle","df_handleOri","cabDesign","cabConstruct","cabHinge","cabWallProf","t_cabWallProf","cabHautComptoir","t_cabHautComptoir","cabDegagementWall","t_cabDegagementWall","cabToeKickHeight","t_cabToeKickHeight","cabToeKickProf","t_cabToeKickProf","cabToeKickType","cabAlignBase","t_cabAlignBase","cabTallHeightAlign","t_cabTallHeightAlign","cabTypeComptoir","tabletteType","drawerConst","drawerSlide","matPatte","patteAchetee","equerre","cacheNeon","beamModele","beamHeight","t_beamHeight","ligne","contrat_id","commande_id","estBloqPrix","estPrixAdmin","estExtra","enErreur","signature","kitUtilisation","specie","bd_specie","df_specie","bd_serie","df_serie","bd_finishColor","df_finishColor","porteModeleB","porteModeleH","porteModeleFacadeB","porteModeleFacadeH","porteModeleBSensGrain","porteModeleHSensGrain","porteModeleFacadeBSensGrain","porteModeleFacadeHSensGrain","porteModeleB_epais","t_porteModeleB_epais","porteModeleH_epais","t_porteModeleH_epais","porteModeleFacadeB_epais","t_porteModeleFacadeB_epais","porteModeleFacadeH_epais","t_porteModeleFacadeH_epais","moulLumModele","moulLumHeight","t_moulLumHeight","moulPiedModele","moulPiedHeight","t_moulPiedHeight","detailSection","aBomCustom","couleurEstBois","items","typeColor"],[["Code du kit"],["Libellé du kit"],["Quantité"],["Quantité (unité de traitement)"],["Type de kit"],["Unité de mesure"],["Sous-total du kit"],["Sous-total du kit (valeur effective)"],["Sous-total général"],["Sous-total général (valeur effective)"],["Total comptoir"],["Total comptoir (valeur effective)"],["Nombre de comptoirs"],["Longueur comptoir"],["Surface comptoir"],["Cumul comptoir"],["Extra comptoir"],["Modèle comptoir"],["Couleur comptoir"],["Groupe couleur comptoir"],["Sous-total cabine"],["Sous-total panneaux"],["Sous-total moulures"],["Sous-total autres éléments"],["Avec assemblage"],["Gamme produit"],["Série"],["Couleur fini"],["Bordure collée"],["Ruban de chant"],["Ruban chant – porte BD"],["Ruban chant – porte DF"],["Ruban chant – porte WD"],["Bordure porte"],["Bordure tablette"],["Poignée"],["Orientation poignée"],["Poignée – porte BD"],["Orientation poignée – porte BD"],["Poignée – porte DF"],["Orientation poignée – porte DF"],["Design armoire"],["Construction armoire"],["Type charnière"],["Profondeur armoire murale"],["Profondeur armoire murale (texte)"],["Hauteur armoire sous-comptoir"],["Hauteur armoire sous-comptoir (texte)"],["Dégagement mur armoire"],["Dégagement mur armoire (texte)"],["Hauteur plinthe"],["Hauteur plinthe (texte)"],["Profondeur plinthe"],["Profondeur plinthe (texte)"],["Type plinthe"],["Alignement base armoire"],["Alignement base armoire (texte)"],["Alignement hauteur armoire haute"],["Alignement hauteur armoire haute (texte)"],["Type comptoir armoire"],["Type tablette"],["Construction tiroir"],["Glissière tiroir"],["Matériau patte"],["Patte achetée"],["Équerre"],["Cache néon"],["Modèle poutre"],["Hauteur poutre"],["Hauteur poutre (texte)"],["Numéro de ligne"],["Identifiant contrat"],["Identifiant commande"],["Prix bloqué"],["Prix administrateur"],["Est extra"],["En erreur"],["Signature"],["Utilisation kit"],["Essence bois"],["Essence bois – porte BD"],["Essence bois – porte DF"],["Série – porte BD"],["Série – porte DF"],["Couleur fini – porte BD"],["Couleur fini – porte DF"],["Modèle porte basse"],["Modèle porte haute"],["Modèle façade porte basse"],["Modèle façade porte haute"],["Sens veinage porte basse"],["Sens veinage porte haute"],["Sens veinage façade porte basse"],["Sens veinage façade porte haute"],["Épaisseur porte basse"],["Épaisseur porte basse (texte)"],["Épaisseur porte haute"],["Épaisseur porte haute (texte)"],["Épaisseur façade porte basse"],["Épaisseur façade porte basse (texte)"],["Épaisseur façade porte haute"],["Épaisseur façade porte haute (texte)"],["Modèle moulure lumière"],["Hauteur moulure lumière"],["Hauteur moulure lumière (texte)"],["Modèle moulure pied"],["Hauteur moulure pied"],["Hauteur moulure pied (texte)"],["Détail section"],["BOM personnalisé"],["Couleur estimée bois"],["Liste items"],["type  couleur"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-etapes" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="table-etapes"><span class="header-section-number">10.5</span> table etapes</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-50258162fe81c09d795a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-50258162fe81c09d795a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7"],["createur","dateCreation","emplacement","statut","tempsCreation","commande_id","contrat_id"],[["Nom du créateur"],["Date de création"],["Emplacement"],["Statut"],["Temps de création"],["Identifiant commande"],["Identifiant contrat"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="tables-addresses" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="tables-addresses"><span class="header-section-number">10.6</span> tables addresses</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-caf35d682c24e72a1800" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-caf35d682c24e72a1800">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],["codePost","etatProv","ligne1","ligne2","pays","region","ville","usage","code","sorte","projet_id","nom","estJS","contact"],[["Code postal"],["État / Province"],["Adresse ligne 1"],["Adresse ligne 2"],["Pays"],["Région"],["Ville"],["Usage (expédition / facturation / chantier)"],["Code de l’adresse"],["Type d’adresse"],["Identifiant projet"],["Libellé ou nom de l’adresse"],["Est une adresse chantier (jobsite)"],["Contact associé"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="lumière" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="lumière"><span class="header-section-number">10.7</span> lumière</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-3ff528b746268acef0ec" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3ff528b746268acef0ec">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["modele","qte","contrat_id"],[["modèle lumière"],["quantité"],[" identifiant contrat"]]],"container":"<table class=\"compact stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Champ<\/th>\n      <th>Label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Champ","targets":1},{"name":"Label","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(projets,<span class="at">file=</span><span class="st">"data/processed/projets.RData"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(commandes,<span class="at">file=</span><span class="st">"data/processed/commandes.RData"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(contrats,<span class="at">file=</span><span class="st">"data/processed/contrats.RData"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(kits,<span class="at">file=</span><span class="st">"data/processed/kits.RData"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(adresses,<span class="at">file=</span><span class="st">"data/processed/adresses.RData"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(etapes,<span class="at">file=</span><span class="st">"data/processed/etapes.RData"</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(lumieres,<span class="at">file=</span><span class="st">"data/processed/lumieres.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="conclusion" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> conclusion</h1>
<p>Ce processus d’extraction transforme efficacement les structures XML complexes en un modèle relationnel exploitable, préservant l’intégrité des données tout en optimisant leur accessibilité pour l’analyse business.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="Acceuil">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Acceuil</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../scripts/data_cleaning.html" class="pagination-link" aria-label="Néttoyage et transformations des données">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Néttoyage et transformations des données</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/datchaa/dunin_etl/blob/main/scripts/data_collection.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>